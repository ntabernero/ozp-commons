<?xml version="1.0" encoding="UTF-8" ?>
<entity-mappings xmlns="http://java.sun.com/xml/ns/persistence/orm"
                 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                 xsi:schemaLocation="http://java.sun.com/xml/ns/persistence/orm http://java.sun.com/xml/ns/persistence/orm_2_0.xsd"
                 version="2.0">
    <persistence-unit-metadata>
        <xml-mapping-metadata-complete/>
    </persistence-unit-metadata>

    <package>org.ozoneplatform.commons.server.domain.model</package>


    <entity name="Entity" class="Entity" access="FIELD">
        <inheritance strategy="TABLE_PER_CLASS"/>
        <entity-listeners>
            <entity-listener class="org.ozoneplatform.commons.server.persistence.jpa.EntityListener">
                <pre-persist method-name="prePersist"/>
                <pre-update method-name="preUpdate"/>
            </entity-listener>
        </entity-listeners>
        <attributes>
            <id name="id">
                <column name="ID"/>
            </id>
            <basic name="created">
                <column name="CREATED"/>
            </basic>
            <basic name="createdBy">
                <column name="CREATED_BY"/>
            </basic>
            <basic name="lastModified">
                <column name="LAST_MODIFIED"/>
            </basic>
            <basic name="lastModifiedBy">
                <column name="LAST_MODIFIED_BY"/>
            </basic>
        </attributes>
    </entity>

    <entity name="Dashboard" class="Dashboard" access="FIELD">
        <inheritance strategy="TABLE_PER_CLASS"/>
        <attributes>
            <basic name="name">
                <column name="NAME" nullable="false"/>
            </basic>
            <basic name="description">
                <column name="DESCRIPTION"/>
            </basic>
            <basic name="layoutConfig">
                <column name="LAYOUT_CONFIG"/>
            </basic>
            <basic name="position">
                <column name="POSITION"/>
            </basic>
            <basic name="isLocked">
                <column name="IS_LOCKED" nullable="false"/>
            </basic>
        </attributes>
    </entity>

    <entity name="DashboardInstance" class="DashboardInstance" access="FIELD">
        <table name="DASHBOARD_INSTANCE"/>
        <attributes>
            <basic name="lastAccessed">
                <column name="LAST_ACCESSED"/>
            </basic>
            <many-to-one name="dashboardTemplate" target-entity="DashboardTemplate" fetch="LAZY">
                <join-column name="DASHBOARD_TEMPLATE_ID"/>
            </many-to-one>
        </attributes>
    </entity>

    <entity name="DashboardTemplate" class="DashboardTemplate" access="FIELD">
        <table name="DASHBOARD_TEMPLATE"/>
        <attributes>
            <many-to-one name="stack" target-entity="Stack" fetch="LAZY" optional="true">
                <join-column name="STACK_ID"/>
            </many-to-one>
            <many-to-many name="mutableWidgetDefinitions" target-entity="WidgetDefinition" fetch="LAZY">
                <join-table name="DASHBOARD_TEMPLATE_WIDGET_DEFINITION">
                    <join-column name="DASHBOARD_TEMPLATE_ID" referenced-column-name="ID"/>
                    <inverse-join-column name="WIDGET_DEFINITION_ID" referenced-column-name="ID"/>
                </join-table>
            </many-to-many>
            <many-to-many name="mutableGroups" target-entity="Group" fetch="LAZY" mapped-by="mutableDashboardTemplates"/>
        </attributes>
    </entity>

    <entity name="Stack" class="Stack" access="FIELD">
        <table name="STACK"/>
        <attributes>
            <basic name="name">
                <column name="NAME" nullable="false"/>
            </basic>
            <basic name="description">
                <column name="DESCRIPTION"/>
            </basic>
            <basic name="urlName">
                <column name="URL_NAME" nullable="false"/>
            </basic>
            <basic name="descriptorUrl">
                <column name="DESCRIPTOR_URL"/>
            </basic>
            <one-to-many name="mutableDashboardTemplates" target-entity="DashboardTemplate" fetch="LAZY" mapped-by="stack"/>
        </attributes>
    </entity>

    <entity name="Principal" class="Principal" access="FIELD">
        <inheritance strategy="TABLE_PER_CLASS"/>
        <attributes>
            <many-to-many name="mutableStacks" target-entity="Stack" fetch="LAZY">
                <join-table name="PRINCIPAL_STACK">
                    <join-column name="PRINCIPAL_ID" referenced-column-name="ID"/>
                    <inverse-join-column name="STACK_ID" referenced-column-name="ID"/>
                </join-table>
            </many-to-many>
            <element-collection name="mutablePreferences" fetch="EAGER">
                <collection-table name="PREFERENCE">
                    <join-column name="PRINCIPAL_ID"/>
                </collection-table>
            </element-collection>
        </attributes>
    </entity>

    <entity name="Person" class="Person" access="FIELD">
        <table name="PERSON"/>
        <attributes>
            <basic name="username">
                <column name="USERNAME" length="100" nullable="false"/>
            </basic>
            <basic name="fullName">
                <column name="FULL_NAME" length="100" nullable="false"/>
            </basic>
            <basic name="email">
                <column name="EMAIL" length="100"/>
            </basic>
            <basic name="lastLogin">
                <column name="LAST_LOGIN"/>
            </basic>
            <basic name="prevLogin">
                <column name="PREV_LOGIN"/>
            </basic>
            <one-to-many name="mutableDashboards" target-entity="DashboardInstance" fetch="LAZY">
                <join-table name="PERSON_DASHBOARD_INSTANCE">
                    <join-column name="PERSON_ID" referenced-column-name="ID"/>
                    <inverse-join-column name="DASHBOARD_INSTANCE_ID" referenced-column-name="ID"/>
                </join-table>
            </one-to-many>
            <one-to-many name="mutablePersonalWidgetDefinitions" target-entity="PersonalWidgetDefinition" fetch="LAZY">
                <join-table name="PERSON_PERSONAL_WIDGET_DEFINITION">
                    <join-column name="PERSON_ID" referenced-column-name="ID"/>
                    <inverse-join-column name="PERSONAL_WIDGET_DEFINITION_ID" referenced-column-name="ID"/>
                </join-table>
            </one-to-many>
        </attributes>
    </entity>

    <entity name="Group" class="Group" access="FIELD">
        <table name="OWF_GROUP"/>
        <attributes>
            <basic name="name">
                <column name="NAME" nullable="false"/>
            </basic>
            <basic name="displayName">
                <column name="DISPLAY_NAME" nullable="false"/>
            </basic>
            <basic name="description">
                <column name="DESCRIPTION" nullable="false"/>
            </basic>
            <basic name="isPermissionsActive">
                <column name="IS_PERMISSIONS_ACTIVE" nullable="false"/>
            </basic>
            <basic name="isAutomatic">
                <column name="IS_AUTOMATIC" nullable="false"/>
            </basic>
            <many-to-many name="mutablePersons" target-entity="Person" fetch="LAZY">
                <join-table name="GROUP_PERSON">
                    <join-column name="GROUP_ID" referenced-column-name="ID"/>
                    <inverse-join-column name="PERSON_ID" referenced-column-name="ID"/>
                </join-table>
            </many-to-many>
            <many-to-many name="mutableWidgetDefinitions" target-entity="WidgetDefinition" fetch="LAZY">
                <join-table name="GROUP_WIDGET_DEFINITION">
                    <join-column name="GROUP_ID" referenced-column-name="ID"/>
                    <inverse-join-column name="WIDGET_DEFINITION_ID" referenced-column-name="ID"/>
                </join-table>
            </many-to-many>
            <many-to-many name="mutableDashboardTemplates" target-entity="DashboardTemplate" fetch="LAZY" >
                <join-table name="GROUP_DASHBOARD_TEMPLATE">
                    <join-column name="GROUP_ID" referenced-column-name="ID"/>
                    <inverse-join-column name="DASHBOARD_TEMPLATE_ID" referenced-column-name="ID"/>
                </join-table>
            </many-to-many>
        </attributes>
    </entity>

    <entity name="WidgetDefinition" class="WidgetDefinition" access="FIELD">
        <table name="WIDGET_DEFINITION"/>
        <attributes>
            <basic name="displayName">
                <column name="DISPLAY_NAME" nullable="false"/>
            </basic>
            <basic name="widgetUrl">
                <column name="WIDGET_URL" nullable="false"/>
            </basic>
            <basic name="imageUrlLarge">
                <column name="IMAGE_URL_LARGE" nullable="false"/>
            </basic>
            <basic name="imageUrlSmall">
                <column name="IMAGE_URL_SMALL" nullable="false"/>
            </basic>
            <basic name="widgetType">
                <column name="WIDGET_TYPE" nullable="false"/>
            </basic>
            <basic name="universalName">
                <column name="UNIVERSAL_NAME"/>
            </basic>
            <basic name="description">
                <column name="DESCRIPTION"/>
            </basic>
            <basic name="descriptorUrl">
                <column name="DESCRIPTOR_URL"/>
            </basic>
            <basic name="version">
                <column name="VERSION"/>
            </basic>
            <basic name="height">
                <column name="HEIGHT"/>
            </basic>
            <basic name="width">
                <column name="WIDTH"/>
            </basic>
            <basic name="isBackground">
                <column name="IS_BACKGROUND"/>
            </basic>
            <basic name="isSingleton">
                <column name="IS_SINGLETON"/>
            </basic>
            <basic name="isVisibleForLaunch">
                <column name="IS_VISIBLE_FOR_LAUNCH"/>
            </basic>
            <basic name="tags">
                <column name="TAGS"/>
            </basic>
            <many-to-many name="mutableGroups" target-entity="Group" fetch="LAZY" mapped-by="mutableWidgetDefinitions"/>
            <element-collection name="mutableReceivableIntents" fetch="LAZY">
                <collection-table name="INTENTS">
                    <join-column name="WIDGET_DEFINITION_ID"/>
                </collection-table>
            </element-collection>
            <element-collection name="mutableSendableIntents" fetch="LAZY">
                <collection-table name="INTENTS">
                    <join-column name="WIDGET_DEFINITION_ID"/>
                </collection-table>
            </element-collection>
        </attributes>
    </entity>

    <entity name="PersonalWidgetDefinition" class="PersonalWidgetDefinition" access="FIELD">
        <table name="PERSONAL_WIDGET_DEFINITION"/>
        <attributes>
            <basic name="displayName">
                <column name="DISPLAY_NAME"/>
            </basic>
            <basic name="position">
                <column name="POSITION"/>
            </basic>
            <basic name="isAssignedToPerson">
                <column name="IS_ASSIGNED_TO_PERSON"/>
            </basic>
            <basic name="isFavorite">
                <column name="IS_FAVORITE"/>
            </basic>
            <basic name="isLaunchDisabled">
                <column name="IS_LAUNCH_DISABLED"/>
            </basic>
            <basic name="isVisibleForLaunch">
                <column name="IS_VISIBLE_FOR_LAUNCH"/>
            </basic>
            <basic name="tags">
                <column name="TAGS"/>
            </basic>
            <many-to-one name="widgetDefinition" target-entity="WidgetDefinition" fetch="LAZY">
                <join-column name="WIDGET_DEFINITION_ID"/>
            </many-to-one>
        </attributes>
    </entity>

    <embeddable class="Preference" access="FIELD">
        <attributes>
            <basic name="namespace">
                <column name="NAMESPACE" nullable="false"/>
            </basic>
            <basic name="name">
                <column name="NAME" nullable="false"/>
            </basic>
            <basic name="value">
                <column name="VALUE" nullable="false"/>
            </basic>
        </attributes>
    </embeddable>

    <embeddable class="Intent" access="FIELD">
        <attributes>
            <basic name="action">
                <column name="ACTION" nullable="false"/>
            </basic>
            <basic name="dataType">
                <column name="DATA_TYPE" nullable="false"/>
            </basic>
        </attributes>
    </embeddable>
</entity-mappings>